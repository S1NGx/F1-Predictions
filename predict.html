<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Predict ‚Äì F1 Predictor</title>
  <link rel="icon" href="logo_short.jpg?v=2" type="image/jpeg" />
  <link rel="stylesheet" href="css/style.css" />
  <style>
    /* Track info panel ‚Äì inlined to guarantee styles load on all deployments */
    .predict-main{max-width:1300px}
    .dash-logo-img{height:54px;width:auto;display:block;object-fit:contain}
    .dash-user .btn{padding:.45rem 1rem;font-size:.9rem}
    .predict-layout{display:flex;gap:2rem;align-items:flex-start}
    .predict-form-col{flex:1;min-width:0}
    .predict-track-col{flex:0 0 440px;position:sticky;top:5rem}
    .track-panel{background:var(--card-bg,#1a1a1a);border:1px solid var(--border,#2a2a2a);border-radius:12px;overflow:hidden}
    .track-panel-imgwrap{background:#0a0a0a;padding:1rem;display:flex;align-items:center;justify-content:center}
    .track-panel-img{width:100%;display:block;object-fit:contain;max-height:380px}
    .track-panel-body{padding:1.25rem}
    .track-panel-title{font-size:1rem;font-weight:700;color:#fff;letter-spacing:.02em;margin-bottom:1rem;padding-bottom:.65rem;border-bottom:1px solid var(--border,#2a2a2a)}
    .track-panel-stats{display:flex;flex-direction:column;gap:.55rem;margin-bottom:1rem}
    .track-stat{display:flex;justify-content:space-between;align-items:baseline;gap:.5rem;font-size:.82rem}
    .track-stat-label{color:#777;flex-shrink:0}
    .track-stat-value{color:#e0e0e0;font-weight:600;text-align:right}
    .track-stat--driver .track-stat-value{color:var(--red,#e10600)}
    .track-panel-desc{margin:0;font-size:.81rem;color:#888;line-height:1.7}
    @media(max-width:900px){.predict-layout{flex-direction:column}.predict-track-col{flex:none;width:100%;position:static}}
  </style>
</head>
<body>

  <!-- ‚îÄ‚îÄ Header ‚îÄ‚îÄ -->
  <header class="dash-header">
    <div class="dash-logo"><img src="logo.png?v=2" alt="GridPick" class="dash-logo-img" /></div>
    <div class="dash-user">
      <a href="calendar.html" class="btn btn-ghost">‚Üê Calendar</a>
      <button id="logout-btn" class="btn btn-ghost">Log out</button>
    </div>
  </header>

  <!-- ‚îÄ‚îÄ Race hero ‚îÄ‚îÄ -->
  <div class="predict-hero" id="race-hero">
    <!-- populated by predict.js -->
  </div>

  <!-- ‚îÄ‚îÄ Main ‚îÄ‚îÄ -->
  <main class="predict-main">
    <div class="predict-layout">

      <!-- ‚îÄ‚îÄ Left: form column ‚îÄ‚îÄ -->
      <div class="predict-form-col">

    <!-- Status banner -->
    <div class="pred-banner" id="pred-banner" style="display:none;"></div>

    <!-- ‚îÄ‚îÄ Prediction form ‚îÄ‚îÄ -->
    <form id="predict-form" class="pred-form" novalidate>

      <!-- Pole Position -->
      <section class="pred-section">
        <div class="pred-section-header">
          <span class="pred-section-title">Pole Position</span>
          <span class="pred-pts">10 pts</span>
        </div>
        <div class="pred-field" id="field-pole">
          <select class="pred-select" name="pole" id="pole">
            <option value="">‚Äî Select driver ‚Äî</option>
          </select>
          <div class="pred-result-badge" id="badge-pole" style="display:none;"></div>
        </div>
      </section>

      <!-- Podium -->
      <section class="pred-section">
        <div class="pred-section-header">
          <span class="pred-section-title">Race Podium</span>
          <span class="pred-pts">25 ¬∑ 18 ¬∑ 15 pts &nbsp;|&nbsp; wrong pos. 10 pts</span>
        </div>

        <div class="pred-podium-row">
          <div class="pred-podium-slot">
            <div class="pred-podium-pos pos-1">P1</div>
            <select class="pred-select" name="podium_p1" id="podium_p1">
              <option value="">‚Äî Driver ‚Äî</option>
            </select>
            <div class="pred-result-badge" id="badge-p1" style="display:none;"></div>
          </div>
          <div class="pred-podium-slot">
            <div class="pred-podium-pos pos-2">P2</div>
            <select class="pred-select" name="podium_p2" id="podium_p2">
              <option value="">‚Äî Driver ‚Äî</option>
            </select>
            <div class="pred-result-badge" id="badge-p2" style="display:none;"></div>
          </div>
          <div class="pred-podium-slot">
            <div class="pred-podium-pos pos-3">P3</div>
            <select class="pred-select" name="podium_p3" id="podium_p3">
              <option value="">‚Äî Driver ‚Äî</option>
            </select>
            <div class="pred-result-badge" id="badge-p3" style="display:none;"></div>
          </div>
        </div>
      </section>

      <!-- Sprint Winner (conditionally shown) -->
      <section class="pred-section" id="sprint-section" style="display:none;">
        <div class="pred-section-header">
          <span class="pred-section-title">üèÉ Sprint Winner</span>
          <span class="pred-pts">8 pts</span>
        </div>
        <div class="pred-field" id="field-sprint">
          <select class="pred-select" name="sprint_win" id="sprint_win">
            <option value="">‚Äî Select driver ‚Äî</option>
          </select>
          <div class="pred-result-badge" id="badge-sprint" style="display:none;"></div>
        </div>
      </section>

      <!-- Best of the Rest -->
      <section class="pred-section">
        <div class="pred-section-header">
          <span class="pred-section-title">Best of the Rest</span>
          <span class="pred-pts">10 pts &nbsp;|&nbsp; first non-top-4 team</span>
        </div>
        <div class="pred-field" id="field-best-tr">
          <select class="pred-select" name="best_tr" id="best_tr">
            <option value="">‚Äî Select team ‚Äî</option>
            <option value="Aston Martin">Aston Martin</option>
            <option value="Alpine">Alpine</option>
            <option value="Williams">Williams</option>
            <option value="Racing Bulls">Racing Bulls</option>
            <option value="Audi">Audi</option>
            <option value="Haas F1 Team">Haas</option>
            <option value="Cadillac">Cadillac</option>
          </select>
          <div class="pred-result-badge" id="badge-best-tr" style="display:none;"></div>
        </div>
      </section>

      <!-- Safety Car / Red Flag -->
      <section class="pred-section">
        <div class="pred-section-header">
          <span class="pred-section-title">Safety Cars &amp; Red Flags</span>
          <span class="pred-pts">10 pts &nbsp;|&nbsp; combined total</span>
        </div>
        <div class="pred-radio-group" id="field-sc">
          <label class="pred-radio-label">
            <input type="radio" name="sc_count" value="0" />
            <span class="pred-radio-btn">0</span>
          </label>
          <label class="pred-radio-label">
            <input type="radio" name="sc_count" value="1-2" />
            <span class="pred-radio-btn">1‚Äì2</span>
          </label>
          <label class="pred-radio-label">
            <input type="radio" name="sc_count" value="3+" />
            <span class="pred-radio-btn">3+</span>
          </label>
        </div>
        <div class="pred-result-badge" id="badge-sc" style="display:none;margin-top:0.4rem;"></div>
      </section>

      <!-- Cars Retired -->
      <section class="pred-section">
        <div class="pred-section-header">
          <span class="pred-section-title">Cars Retired</span>
          <span class="pred-pts">10 pts exact &nbsp;|&nbsp; 5 pts ¬±1</span>
        </div>
        <div class="pred-field" id="field-retired">
          <select class="pred-select" name="retirements" id="retirements" style="max-width:180px;">
            <option value="">‚Äî Select ‚Äî</option>
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10+</option>
          </select>
          <div class="pred-result-badge" id="badge-retired" style="display:none;"></div>
        </div>
      </section>

      <!-- Submit -->
      <div class="pred-submit-row">
        <button type="submit" class="btn btn-primary pred-submit" id="submit-btn">
          Save Prediction
        </button>
        <span class="pred-saved-note" id="saved-note"></span>
      </div>

    </form>

    <!-- Score summary (shown after results arrive) -->
    <div class="pred-score-card" id="score-card" style="display:none;">
      <div class="pred-score-heading">Your Score</div>
      <div class="pred-score-total" id="score-total"></div>
      <div class="pred-score-breakdown" id="score-breakdown"></div>
    </div>

    <!-- Fetch results button (always shown after race, triggers OpenF1 pull) -->
    <div class="pred-fetch-row" id="fetch-row" style="display:none;">
      <button class="btn btn-ghost" id="fetch-btn">üîÑ Fetch Official Results from OpenF1</button>
      <span class="pred-fetch-note" id="fetch-note"></span>
    </div>

      </div><!-- /.predict-form-col -->

      <!-- ‚îÄ‚îÄ Right: track info panel ‚îÄ‚îÄ -->
      <aside class="predict-track-col" id="track-panel"></aside>

    </div><!-- /.predict-layout -->
  </main>

  <script src="js/auth.js"></script>
  <script src="js/predict.js"></script>
</body>
</html>
